分布式协调服务，精简的文件系统   用于实现多种协调数据结构和协议，分布式队列，分布式锁和领导者选举。    
高可用     
进程间彼此发现并进行消息交互。      
部分失败在分布式系统中不能避免，zookeeper可以在你构建分布式应用时正确处理部分失败。   
zoo.cfg:
tickTime,datadir,clientport   
```text
zkServer.sh start
echo ruok | nc localhost 2181  
```

zk实现了一个主动的能够在外部事件发生时修改数据项状态的数据结构。组成员管理应用


###组成员关系
zk是一个高可用的文件系统，没有文件和目录，统一使用节点的概念(znode)。znode既可以保存数据，也可以保存其他znode。   
两种znode：短暂的和持久的。客户端断开连接时，短暂znode会被删除，持久znode则不会  
删除znode参数：节点路径和版本号，不支持递归删除   

### ZK服务
znode存储1MB数据以内，zk的数据访问具有原子性，zk不支持添加操作。   
**zk适用于构建分布式应用**
>* 短暂znode不可以有子节点，对于需要知道特定时刻有哪些分布式资源可用的应用来说，使用短暂znode是好的选择。 
>* 顺序号，在分布式系统中，顺序号可以被用于为所有的时间进行全局排序，客户端可以通过顺序号来推断事件的顺序。
>* 观察机制，观察只能被触发一次。  

#### 实现
集合体包含奇数台机器。 对znode的树的每一个修改都会被复制到集合体中超过半数的机器上，zab协议：领导者选举（半数以上的跟随者将其状态与领导者同步）和原子广播（任何写操作都会被转送给领导者，然后广播，类似的paxos算法是依靠tcp来保证消息的顺序）

#### 数据一致性
顺序一致性，原子性，单一系统镜像，持久性，及时性(客户端之间  sync)

#### 会话
客户端和zk服务器建立连接，就会创建一个会话  
超时时间设置，过期， 恢复一个会话代价大，可以将会话id和密码存到一个稳定的存储器中。   
zk服务器越多，会话超时设置越大，连接超时，读超时和ping周期越小

#### 状态
connecting，connected，closed  

### 异常处理
InterruptedException
KeeperException

### 锁服务
分布式锁能够在一组进程之间提供互斥机制，使得在任何时候只有一个进程可以持有锁。分布式锁可以用于在大型分布式系统中实现领导者选举，在任何时候，持有锁的那个进程就是系统的
领导者。
zk使用顺序znode为那些竞争锁的进程强制排序。/leader，/leader/lock-1，/leader/lock-2   
